<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ShellCoach Terminal</title>
  <style>
    body {
      background-color: #0d0d0d;
      color: #00ffcc;
      font-family: monospace;
      padding: 20px;
    }
    .logo {
      width: 300px;
      margin-bottom: 10px;
    }
    #toggle-container {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    #toggle-container label {
      margin-left: 10px;
    }
    #terminal {
      width: 100%;
      height: 400px;
      background-color: #1e1e1e;
      padding: 10px;
      overflow-y: auto;
      white-space: pre-wrap;
      border: 1px solid #00ffcc;
    }
    input {
      width: 100%;
      padding: 10px;
      background: #111;
      color: #00ffcc;
      border: none;
    }
  </style>
</head>
<body>
  <img src="/static/shellcoach_logo.png" class="logo" alt="ShellCoach Logo">
  <div id="toggle-container">
    <input type="checkbox" id="ai-toggle" checked>
    <label for="ai-toggle">ðŸ’¡ Enable AI Command Explanations</label>
  </div>
  <div id="terminal">user@shellcoach:~$</div>
  <input id="input" placeholder="Type a command..." autofocus>
  <script>
    const terminal = document.getElementById('terminal');
    const input = document.getElementById('input');
    const aiToggle = document.getElementById('ai-toggle');

    input.addEventListener('keydown', async (e) => {
      if (e.key === 'Enter') {
        const cmd = input.value;
        terminal.innerHTML += `\n${cmd}`;
        input.value = '';

        const res = await fetch('/execute', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ command: cmd })
        });
        const data = await res.json();
        terminal.innerHTML += `\n${data.output}`;

        if (aiToggle.checked) {
          const explanation = await fetch('/explain', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ command: cmd })
          });
          const explainData = await explanation.json();
          terminal.innerHTML += `\n\nðŸ’¡ ShellCoach Explanation: ${explainData.explanation}`;
        }

        terminal.innerHTML += `\nuser@shellcoach:~$`;
        terminal.scrollTop = terminal.scrollHeight;
      }
    });
  </script>
</body>
</html>
